# ü¶Ü duck-local-chat-api

> –õ–æ–∫–∞–ª—å–Ω—ã–π API-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å AI-–º–æ–¥–µ–ª—è–º–∏ —á–µ—Ä–µ–∑ [duck.ai](https://duck.ai), –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞.

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å **–ª–æ–∫–∞–ª—å–Ω—ã–π FastAPI-—Å–µ—Ä–≤–µ—Ä**, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ AI-–º–æ–¥–µ–ª—è–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, GPT-4o), –∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å duck.ai ‚Äî –Ω–æ —É–∂–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ, —á–µ—Ä–µ–∑ API.

---

## üöÄ –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

Duck.ai –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—É–±–ª–∏—á–Ω–æ–≥–æ API, –Ω–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—â–∞—Ç—å—Å—è —Å –º–æ—â–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ.  
`duck-local-chat-api` –æ–±—Ö–æ–¥–∏—Ç —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ, **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞—è –≤–∞–ª–∏–¥–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤** —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π —Å–∫—Ä–∏–ø—Ç, –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Å—Ç–æ–π HTTP-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ —Å–≤–æ–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## ‚öôÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **Playwright** + **Chromium** –≤ —Ñ–æ–Ω–µ (–Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–º –¥–∏—Å–ø–ª–µ–µ) –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å) –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–µ–π—Å—Ç–≤—É—é—â–∏–µ `–∑–∞–≥–æ–ª–æ–≤–∫–∏` (–≤–∫–ª—é—á–∞—è `vqd`).
- –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API duck.ai.
- –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç **–ª–æ–∫–∞–ª—å–Ω–æ**, –±–µ–∑ –ø–µ—Ä–µ–¥–∞—á–∏ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∫—É–¥–∞-–ª–∏–±–æ.

---

## üñ•Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- [FastAPI](https://fastapi.tiangolo.com/) ‚Äî –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è API
- [Playwright (patchright)](https://github.com/Kaliiiiiiiiii-Vinyzu/patchright) ‚Äî –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏  (undetected)
- [xvfbwrapper](https://pypi.org/project/xvfbwrapper/) ‚Äî —Å–æ–∑–¥–∞—ë—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω (–¥–ª—è headless-—Ä–∞–±–æ—Ç—ã)
- `notify-send` ‚Äî Linux-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ
- –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ [`mrgick/duck_chat`](https://github.com/mrgick/duck_chat)

> ‚ö†Ô∏è **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ Linux** (–∏–∑-–∑–∞ `xvfb` –∏ `notify-send`).

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/paranoik1/duck-local-chat-api
cd duck-local-chat-api

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ poetry
poetry install --no-root
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
poetry env use python3.13
# –í—Ö–æ–¥ –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
$(poetry env activate)

# –ú–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å –ø–æ–º–æ—â—å—é pip
# –°–æ–∑–¥–∞–Ω–∏–µ python –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv .venv
# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –µ–≥–æ
source .venv/bin/activate
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ –∏–∑ requirements.txt
pip install -r requirements.txt
```

> –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã `xvfb` –∏ `libnotify-bin`:
>
> ```bash
> sudo apt install xvfb libnotify-bin
> ```

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

```bash
python main.py
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://127.0.0.1:8000`.

---

## üì° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API

### –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ

```bash
curl -X POST http://127.0.0.1:8000/chat \
  -H "Content-Type: application/json" \
  -d '{
    "content": "–ü—Ä–∏–≤–µ—Ç! –ö—Ç–æ —Ç—ã?",
    "model": "gpt-4o-mini"
  }'
```

> –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏ `duck_chat/models/model_type.py`:
- `Gpt4OMini` ‚Üí **gpt-4o-mini**
- `Gpt4OMini` = **gpt-4o-mini**
- `Gpt5Mini` = **gpt-5-mini**
- `GptOss120B` = **openai/gpt-oss-120b**
- `Llama4Scout17B16EInstruct` = **meta-llama/Llama-4-Scout-17B-16E-Instruct**
- `Claude35HaikuLatest` = **claude-3-5-haiku-latest**
- `MistralSmall24BInstruct2501` = **mistralai/Mistral-Small-24B-Instruct-2501**

**–û—Ç–≤–µ—Ç:**
```json
"–ü—Ä–∏–≤–µ—Ç! –Ø ‚Äî –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç, –≥–æ—Ç–æ–≤—ã–π –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å –ª—é–±—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏‚Ä¶"
```

> ‚ö†Ô∏è –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä—Å–∏—Ç—Å—è —Å Duck.ai API —Å–µ—Ä–≤–∏—Å–æ–º –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–∏—Å–∞ - –ø–æ—ç—Ç–æ–º—É –≤—ã—à–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—á–µ–Ω—å –º–æ–¥–µ–ª–µ–π –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º, —Å–º–æ—Ç—Ä–∏—Ç–µ `duck_chat/models/model_type.py`

---

## üîÅ –ö–∞–∫ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–∏?

- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤–∞–ª–∏–¥–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤.
- –ï—Å–ª–∏ –æ–Ω–∏ —É—Å—Ç–∞—Ä–µ–ª–∏ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ñ–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞, –∫–æ—Ç–æ—Ä–∞—è:
  1. –ó–∞–ø—É—Å–∫–∞–µ—Ç Chromium –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–º –¥–∏—Å–ø–ª–µ–µ
  2. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ duck.ai
  3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
  4. –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏–∑ API-–∑–∞–ø—Ä–æ—Å–∞
  5. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –í—ã –ø–æ–ª—É—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: `–ó–∞–≥–æ–ª–æ–≤–∫–∏ –ø–æ–ª—É—á–µ–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã`

> –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –æ—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ (`ChallengeException`), —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
duck-local-chat-api/
‚îú‚îÄ‚îÄ service.py            # –û—Å–Ω–æ–≤–Ω–æ–π FastAPI-—Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ utils.py              # –°–∫—Ä–∏–ø—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —á–µ—Ä–µ–∑ Playwright
‚îú‚îÄ‚îÄ headers_manager.py    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º/–∑–∞–≥—Ä—É–∑–∫–æ–π –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
‚îî‚îÄ‚îÄ duck_chat/            # –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å duck.ai
```

---

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –¢–æ–ª—å–∫–æ **Linux** (–∏–∑-–∑–∞ `xvfb` –∏ `notify-send`)
- –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ (–Ω—É–∂–Ω–∞ –ª–∏—à—å –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –æ—Å–Ω–æ–≤–≥–æ –ø—Ä–æ–º–ø—Ç–∞)
- –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤–∞–ª–∏–¥–Ω—ã (–≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ ‚Äî 5-10 –∑–∞–ø—Ä–æ—Å–æ–≤)
- –ù–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (—Å–ª–µ–¥—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞–º duck.ai)
- –¢—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ Chromium –∏ GUI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

---

## ü§ù –ê–≤—Ç–æ—Ä

–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AI –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –ª–∏—à–Ω–∏—Ö –¥–≤–∏–∂–µ–Ω–∏–π.  
–ê–≤—Ç–æ—Ä –Ω–µ –Ω–µ—Å—ë—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª duck.ai –ø—Ä–∏ –º–∞—Å—Å–æ–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏.

---

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- [mrgick/duck_chat](https://github.com/mrgick/duck_chat) ‚Äî –∑–∞ –æ—Å–Ω–æ–≤—É
- [patchright](https://github.com/Kaliiiiiiiiii-Vinyzu/patchright) ‚Äî –∑–∞ –æ—Ç–ª–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø–æ –æ–±—Ö–æ–¥—É –ø—Ä–æ–≤–µ—Ä–æ–∫ –Ω–∞ –±–æ—Ç–æ–≤
- Playwright & FastAPI ‚Äî –∑–∞ –æ—Ç–ª–∏—á–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

---

> ü¶Ü –£—Ç–∫–∏ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è, –Ω–æ API ‚Äî –¥–∞.  
> –ü–æ–ª—å–∑—É–π—Ç–µ—Å—å —Å —É–º–æ–º.
